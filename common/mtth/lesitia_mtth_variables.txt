food_civ_core_consumption = {
	base = 0
	modifier = {
		set_temp_variable = { core_cons = 0 }
		all_controlled_state = {
			if = {
				limit = { is_core_of = PREV }
				add_to_temp_variable = { core_cons  = state_population_k }
			}
		}
		if = {
			limit = { check_variable = { modifier@civ_core_food_modifier < 100 } }
			divide_temp_variable = { core_cons = 100 }
			multiply_temp_variable = { core_cons = modifier@civ_core_food_modifier }	
		}
		divide_temp_variable = { core_cons = 1000 }
		round_temp_variable = core_cons
		add = core_cons
	}
}

food_civ_non_core_consumption = {
	base = 0
	modifier = {
		set_temp_variable = { non_core_cons = 0 }
		all_controlled_state = {
			if = {
				limit = { NOT = {  is_core_of = PREV } }
				add_to_temp_variable = { non_core_cons  = state_population_k }
			}
		}
		if = {
			limit = { check_variable = { modifier@civ_non_core_food_modifier < 100 } }
			divide_temp_variable = { non_core_cons = 100 }
			multiply_temp_variable = { non_core_cons = modifier@civ_non_core_food_modifier }	
		}
		divide_temp_variable = { non_core_cons = 1000 }
		round_temp_variable = non_core_cons
		add = non_core_cons
	}
}

food_mil_consumption = {
	base = 0
	modifier = {
		set_temp_variable = { mil_cons = num_battalions }
		divide_temp_variable = { mil_cons = 10 }
		round_temp_variable = mil_cons
		add = mil_cons
	}
}

food_total_consumption = {
	base = 0
	modifier = {
		set_temp_variable = { food_c = food_mil_consumption_i }
		add_to_temp_variable = { food_c = food_civ_core_consumption_i }
		add_to_temp_variable = { food_c = food_civ_non_core_consumption_i }
		subtract_from_temp_variable = { food_c = food_surplus }
		clamp_temp_variable = {
			var = food_c
			min = 0
			max = 100000
		}
		add = food_c
	}
}

coalition_popularity = {
	base = 0
	modifier = {
		set_temp_variable = { coal_popularity = 0 }
		if = {
			limit = {
				NOT = {
					has_government = despotism
				}
				has_country_flag = coalition_despotism
			}
			add_to_temp_variable = { coal_popularity = party_popularity_100@despotism }
		}
		if = {
			limit = {
				NOT = {
					has_government = revolutionarism
				}
				has_country_flag = coalition_revolutionarism
			}
			add_to_temp_variable = { coal_popularity = party_popularity_100@revolutionarism }
		}
		if = {
			limit = {
				NOT = {
					has_government = corporatism
				}
				has_country_flag = coalition_corporatism
			}
			add_to_temp_variable = { coal_popularity = party_popularity_100@corporatism }
		}
		if = {
			limit = {
				NOT = {
					has_government = supremacism
				}
				has_country_flag = coalition_supremacism
			}
			add_to_temp_variable = { coal_popularity = party_popularity_100@supremacism }
		}
		if = {
			limit = {
				NOT = {
					has_government = democracy
				}
				has_country_flag = coalition_democracy
			}
			add_to_temp_variable = { coal_popularity = party_popularity_100@democracy }
		}
		if = {
			limit = {
				NOT = {
					has_government = technocracy
				}
				has_country_flag = coalition_technocracy
			}
			add_to_temp_variable = { coal_popularity = party_popularity_100@technocracy }
		}
		if = {
			limit = {
				NOT = {
					has_government = theocracy
				}
				has_country_flag = coalition_theocracy
			}
			add_to_temp_variable = { coal_popularity = party_popularity_100@theocracy }
		}
		if = {
			limit = {
				NOT = {
					has_government = unclassified
				}
				has_country_flag = coalition_unclassified
			}
			add_to_temp_variable = { coal_popularity = party_popularity_100@unclassified }
		}
		clamp_temp_variable = {
			var = coal_popularity
			min = 0
			max = 100
		}
		add = coal_popularity
	}
}

coalition_popularity_stab = {
	base = 0
	modifier = {
		set_temp_variable = { coal_popularity_stab = coalition_popularity_v }
		multiply_temp_variable = { coal_popularity_stab = 20 }
		divide_temp_variable = { coal_popularity_stab = 10000 }
		add = coal_popularity_stab
	}
}

army_xp_cost_professionnalism = {
	base = 0
	modifier = {
		set_temp_variable = { pop_factor = max_manpower_k }
		divide_temp_variable = { pop_factor = 1000 }
		round_temp_variable = pop_factor
		add = pop_factor
	}
}

army_xp_cost_professionnalism_n = {
	base = 0
	modifier = {
		set_temp_variable = { pop_factor = max_manpower_k }
		divide_temp_variable = { pop_factor = -1000 }
		round_temp_variable = pop_factor
		add = pop_factor
	}
}