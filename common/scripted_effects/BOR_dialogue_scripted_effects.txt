dialogue_bor_1_init = {
	set_country_flag = dialogue_system
	set_country_flag = bor_entry_dialogue
	set_country_flag = two_chars
	set_variable = { bor_dialogue_progress = 0 }
	
	add_to_array = { char1_talking_turns = 1 }
	add_to_array = { char1_talking_turns = 3 }
	add_to_array = { char1_talking_turns = 5 }
	
	add_to_array = { char2_talking_turns = 2 }
	add_to_array = { char2_talking_turns = 4 }

}

dialogue_bor_1_reset = {
	close_dialogue = yes
	dialogue_bor_1_init = yes
}

bor_dialogue_progress = {
	if = {
		limit = { 
			NOT = { has_country_flag = dialogue_choice }
		}
		add_to_variable = { bor_dialogue_progress = 1 }
	}
	if = {
		limit = { 
			has_country_flag = two_chars
		}
		dialogue_two_chars_progress = yes
	}
	if = {
		limit = { 
			has_country_flag = bor_entry_dialogue
		}
		dialogue_bor_1_progress = yes
	}
}

dialogue_two_chars_progress = {
	if = {
		limit = { 
			is_in_array = {
				array = char1_talking_turns
				value = bor_dialogue_progress
			}
		}
		set_country_flag = char1_talking
	}
	else = {
		clr_country_flag = char1_talking
	}
	if = {
		limit = { 
			is_in_array = {
				array = char2_talking_turns
				value = bor_dialogue_progress
			}
		}
		set_country_flag = char2_talking
	}
	else = {
		clr_country_flag = char2_talking
	}
}

dialogue_bor_1_progress = {
	if = {
		limit = { 
			has_country_flag = bor_entry_dialogue
			check_variable = { bor_dialogue_progress = 6 }
		}
		bor_close_dialogue = yes
	}
}

bor_close_dialogue = {
	clr_country_flag = dialogue_system
	clr_country_flag = bor_entry_dialogue
	clr_country_flag = dialogue_choice
	clr_country_flag = two_chars
	clear_variable = bor_dialogue_progress
	clear_array = char1_talking_turns
	clear_array = char2_talking_turns
}

##########################
#test multiple characters#
##########################
test_init = {
	set_country_flag = dialogue_system
	set_country_flag = test_dialogue
	set_country_flag = three_chars
	set_variable = { test_progress = 0 }
	
	add_to_array = { char1_talking_turns = 3 }
	add_to_array = { char1_talking_turns = 6 }

	add_to_array = { char2_talking_turns = 1 }
	add_to_array = { char2_talking_turns = 4 }

	add_to_array = { char3_talking_turns = 2 }
	add_to_array = { char3_talking_turns = 5 }


}
test_reset = {
	close_dialogue = yes
	test_init = yes
}

test_progress = {
	if = {
		limit = { 
			NOT = { has_country_flag = dialogue_choice }
		}
		add_to_variable = { test_progress = 1 }
	}
	if = {
		limit = { 
			has_country_flag = three_chars
		}
		dialogue_three_chars_progress = yes
	}
	if = {
		limit = { 
			has_country_flag = test_dialogue
		}
		test_progress_checks = yes
	}
}
dialogue_three_chars_progress = {
	if = {
		limit = { 
			is_in_array = {
				array = char1_talking_turns
				value = bor_dialogue_progress
			}
		}
		set_country_flag = char1_talking
	}
	else = {
		clr_country_flag = char1_talking
	}
	if = {
		limit = { 
			is_in_array = {
				array = char2_talking_turns
				value = bor_dialogue_progress
			}
		}
		set_country_flag = char2_talking
	}
	else = {
		clr_country_flag = char2_talking
	}
	if = {
		limit = { 
			is_in_array = {
				array = char3_talking_turns
				value = bor_dialogue_progress
			}
		}
		set_country_flag = char3_talking
	}
	else = {
		clr_country_flag = char3_talking
	}
}

test_progress_checks = {
	if = {
		limit = { 
			has_country_flag = test_dialogue
			check_variable = { test_progress = 7 }
		}
		test_close_dialogue = yes
	}
}

test_close_dialogue = {
	clr_country_flag = dialogue_system
	clr_country_flag = test_dialogue
	clr_country_flag = dialogue_choice
	clr_country_flag = three_chars
	clear_variable = bor_dialogue_progress
	clear_array = char1_talking_turns
	clear_array = char2_talking_turns
	clear_array = char3_talking_turns

}